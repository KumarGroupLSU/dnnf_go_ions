@SET SYSNAME       go4ff2_20_20_hydcl_2_NVT-00000-00500
@SET CP2KVERSION   7.1
! When infos are written
@SET STDPRINT      1
@SET TRAJMDPRINT   1
! When restart are written
@SET RSTSCF        20
@SET RSTMD         20
! Name of EXT_RESTART files (MD and/or SCF)
@SET OLDRESTARTMD  go4ff2_20_20_hydcl_2_01-CELL_OPT.restart
@SET OLDRESTARTSCF go4ff2_20_20_hydcl_2_01-SCF.wfn

&GLOBAL
 PRINT_LEVEL LOW
 PREFERRED_FFT_LIBRARY FFTW3
 EXTENDED_FFT_LENGTHS TRUE
 PROJECT ${SYSNAME}
 RUN_TYPE MD
 WALLTIME 59:45:00
&END GLOBAL
&MOTION
 &MD
  ENSEMBLE        NVT
  STEPS           1000
  TIMESTEP [fs]   0.5
  TEMPERATURE [K] 300.0
  &THERMOSTAT
   TYPE CSVR
   REGION GLOBAL
   &CSVR
    TIMECON [fs] 100.
   &END CSVR
  &END THERMOSTAT
#  &BAROSTAT
#   PRESSURE [bar]  1.
#   TIMECON [fs]    500.
#  &END BAROSTAT
  &PRINT
   &ENERGY
    FILENAME =${SYSNAME}-Energy.en
    LOG_PRINT_KEY
    &EACH
     MD ${STDPRINT}
    &END EACH
    ADD_LAST NUMERIC
   &END ENERGY
   &PROGRAM_RUN_INFO
    FILENAME =${SYSNAME}-Motion.log
    LOG_PRINT_KEY
    &EACH
     MD ${STDPRINT}
    &END EACH
    ADD_LAST NUMERIC
   &END PROGRAM_RUN_INFO
  &END PRINT
 &END MD
 &PRINT
  &TRAJECTORY
   FORMAT XYZ
   UNIT angstrom
   FILENAME =${SYSNAME}-Trajectory.xyz
   LOG_PRINT_KEY
   &EACH
    MD ${TRAJMDPRINT}
   &END EACH
   ADD_LAST NUMERIC
  &END TRAJECTORY
  &RESTART
   FILENAME =${SYSNAME}-MD.restart
   LOG_PRINT_KEY
   &EACH
    MD ${RSTMD}
   &END EACH
   ADD_LAST NUMERIC
  &END RESTART
  &VELOCITIES
   FORMAT XYZ
   UNIT angstrom
   FILENAME =${SYSNAME}-Velocities.xyz
   LOG_PRINT_KEY
   &EACH
    MD ${TRAJMDPRINT}
   &END EACH
   ADD_LAST NUMERIC
  &END VELOCITIES
  &CELL
   FILENAME =${SYSNAME}-Cell.cell
   LOG_PRINT_KEY
   &EACH
    MD ${TRAJMDPRINT}
   &END EACH
   ADD_LAST NUMERIC
  &END CELL
  &RESTART_HISTORY ON
   FILENAME MD
   LOG_PRINT_KEY
   &EACH
    MD ${RSTMD}
   &END EACH
   ADD_LAST NUMERIC
  &END RESTART_HISTORY
 &END PRINT
&END MOTION
&FORCE_EVAL
 METHOD QS
 &DFT
  BASIS_SET_FILE_NAME   /home/cdavro/programs/cp2k/data/${CP2KVERSION}/BASIS_MOLOPT
  POTENTIAL_FILE_NAME   /home/cdavro/programs/cp2k/data/${CP2KVERSION}/GTH_POTENTIALS
  WFN_RESTART_FILE_NAME ${OLDRESTARTSCF}
  CHARGE 0
  MULTIPLICITY 1
  &MGRID
   SKIP_LOAD_BALANCE_DISTRIBUTED FALSE
   CUTOFF [Ry] 600.0
   REL_CUTOFF [Ry] 60.0
   NGRIDS 4
   COMMENSURATE TRUE
  &END MGRID
  &SCF
   MAX_SCF    35
   EPS_SCF    5.0E-7
   SCF_GUESS  RESTART
   &OUTER_SCF
    EPS_SCF 2.0E-6
    MAX_SCF 5
   &END OUTER_SCF
   &OT T
    PRECONDITIONER FULL_SINGLE_INVERSE
    MINIMIZER      DIIS
    N_HISTORY_VEC  7
   &END OT
   &PRINT
    &RESTART
     FILENAME SCF
     LOG_PRINT_KEY
     BACKUP_COPIES 0
     &EACH
      QS_SCF 0
      MD ${RSTSCF}
     &END EACH
     COMMON_ITERATION_LEVELS 1
     ADD_LAST NUMERIC
    &END RESTART
    &RESTART_HISTORY OFF
    &END RESTART_HISTORY
   &END PRINT
  &END SCF
  &QS
   METHOD              GPW
   EPS_DEFAULT         1.0E-14
   EXTRAPOLATION       ASPC
   EXTRAPOLATION_ORDER 3
   MAP_CONSISTENT      TRUE
  &END QS
  &XC
   DENSITY_CUTOFF  1.0E-10
   GRADIENT_CUTOFF 1.0E-10
   &XC_GRID
    XC_SMOOTH_RHO NN10
    XC_DERIV      SPLINE2_SMOOTH
   &END XC_GRID
   &XC_FUNCTIONAL
    &PBE
     PARAMETRIZATION REVPBE
    &END PBE
   &END XC_FUNCTIONAL
   &VDW_POTENTIAL
    POTENTIAL_TYPE PAIR_POTENTIAL
    &PAIR_POTENTIAL
     R_CUTOFF 10.0
     TYPE     DFTD3
     PARAMETER_FILE_NAME  dftd3.dat
     REFERENCE_FUNCTIONAL revPBE
     VERBOSE_OUTPUT
    &END PAIR_POTENTIAL
   &END VDW_POTENTIAL
  &END XC
  &POISSON
   POISSON_SOLVER PERIODIC
   PERIODIC XYZ
  &END POISSON
  &PRINT
   &MULLIKEN
    FILENAME =${SYSNAME}-Mulliken.mull
    LOG_PRINT_KEY
    &EACH
     MD ${TRAJMDPRINT}
    &END EACH
    ADD_LAST NUMERIC
   &END MULLIKEN
  &END PRINT
 &END DFT
 STRESS_TENSOR ANALYTICAL
 &SUBSYS
#  &CELL
#   ABC [angstrom]         21.319 21.292 70.000
#   ALPHA_BETA_GAMMA [deg] 90.000 90.000 90.000
#   MULTIPLE_UNIT_CELL 1 1 1
#   PERIODIC XYZ
#   SYMMETRY ORTHORHOMBIC
#  &END CELL
#  &TOPOLOGY
#   COORD_FILE_FORMAT XYZ
#   COORD_FILE_NAME   0ns.xyz
#  &END TOPOLOGY
  &KIND C
   BASIS_SET DZVP-MOLOPT-SR-GTH
   POTENTIAL GTH-PBE-q4
  &END KIND
  &KIND O
   BASIS_SET DZVP-MOLOPT-SR-GTH
   POTENTIAL GTH-PBE-q6
  &END KIND
  &KIND H
   BASIS_SET DZVP-MOLOPT-SR-GTH
   POTENTIAL GTH-PBE-q1
  &END KIND
  &KIND Cl
   BASIS_SET DZVP-MOLOPT-SR-GTH
   POTENTIAL GTH-PBE-q7
  &END KIND
 &END SUBSYS
 &PRINT
  &PROGRAM_RUN_INFO
   LOG_PRINT_KEY
   &EACH
    MD ${STDPRINT}
   &END EACH
   ADD_LAST NUMERIC
  &END PROGRAM_RUN_INFO
  &FORCES
   FILENAME =${SYSNAME}-Forces.for
   LOG_PRINT_KEY
   &EACH
    MD ${TRAJMDPRINT}
   &END EACH
   ADD_LAST NUMERIC
  &END FORCES
 &END PRINT
&END FORCE_EVAL
&EXT_RESTART
 RESTART_DEFAULT      FALSE
# RESTART_COUNTERS     TRUE
# RESTART_AVERAGES     TRUE
# RESTART_VEL          TRUE
 RESTART_POS          TRUE
# RESTART_RANDOMG      TRUE
# RESTART_THERMOSTAT   TRUE
 RESTART_CELL         TRUE
# RESTART_METADYNAMICS TRUE
 RESTART_FILE_NAME ${OLDRESTARTMD}
&END EXT_RESTART
